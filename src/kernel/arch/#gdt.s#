; frome devse.wiki 

gdtr_install:
    lgdt [rdi]
    push rbp            
    mov rbp, rsp        ; sauvegarder la stack en utilisant le registre rbp
  
    push qword 0x10     ; le segment de données du kernel (-> ss)
    push rbp            ; sauvegarde la stack  (-> RSP)
    pushf               ; pousse les flags dans la stack (-> rflags)
    push qword 0x8      ; pousse le segment de de code du kernel (-> cs)
    push .trampoline    ; pousse le futur point de retour (-> RIP) 

    iretq               ; provoque un "retour" d'interruption, le cpu pop alors 
                        ; toutes les données au dessus pour les registres destinés
.trampoline:
    pop rbp
    ; met tout les segments avec leurs valeurs ciblants le segment de données
    mov ax, 0x10

    mov ds, ax
    mov es, ax
    mov ss, ax
    ret
